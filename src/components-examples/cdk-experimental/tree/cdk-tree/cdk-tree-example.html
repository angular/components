<div class="example-tree-controls">
  <mat-checkbox [formControl]="wrap">Wrap</mat-checkbox>
  <mat-checkbox [formControl]="multi">Multi</mat-checkbox>
  <mat-checkbox [formControl]="disabled">Disabled</mat-checkbox>
  <mat-checkbox [formControl]="skipDisabled">Skip Disabled</mat-checkbox>

  <mat-form-field subscriptSizing="dynamic" appearance="outline">
    <mat-label>Orientation</mat-label>
    <mat-select [(value)]="orientation">
      <mat-option value="vertical">Vertical</mat-option>
      <mat-option value="horizontal">Horizontal</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field subscriptSizing="dynamic" appearance="outline">
    <mat-label>Selection Strategy</mat-label>
    <mat-select [(value)]="selectionMode">
      <mat-option value="explicit">Explicit</mat-option>
      <mat-option value="follow">Follow</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field subscriptSizing="dynamic" appearance="outline">
    <mat-label>Focus Strategy</mat-label>
    <mat-select [(value)]="focusMode">
      <mat-option value="roving">Roving</mat-option>
      <mat-option value="activedescendant">Active Descendant</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div class="example-tree-output">
  <strong>Selected Values:</strong> {{ selectedValues().join(', ') || 'None' }}
</div>

<ul
  cdkTree
  hierarchicalInjector
  class="example-tree"
  [orientation]="orientation"
  [multi]="multi.value"
  [disabled]="disabled.value"
  [selectionMode]="selectionMode"
  [focusMode]="focusMode"
  [wrap]="wrap.value"
  [skipDisabled]="skipDisabled.value"
  [(value)]="selectedValues"
  #tree="cdkTree"
  #injector="hierarchicalInjector"
>
  @for (node of treeData; track node) {
    <ng-template
      [ngTemplateOutlet]="nodeTmpl"
      [ngTemplateOutletContext]="{node: node}"
      [ngTemplateOutletInjector]="injector.injector"
    ></ng-template>
  }
</ul>

<ng-template #nodeTmpl let-node="node">
  <li
    cdkTreeItem
    class="example-tree-item"
    [value]="node.value"
    [label]="node.label || node.value"
    [disabled]="node.disabled"
    #treeItem="cdkTreeItem"
  >
    <span
      class="example-tree-item-content"
      [style.paddingLeft.px]="(treeItem.pattern.level() - 1) * 24"
    >
      <mat-icon class="example-tree-item-icon" aria-hidden="true">
        @if (treeItem.pattern.expandable()) {
          {{ treeItem.pattern.expanded() ? 'expand_less' : 'expand_more' }}
        }
      </mat-icon>
      {{ node.label }}
    </span>

    @if (node.children && node.children.length > 0) {
      <div cdkTreeGroup hierarchicalInjector [value]="node.value" #injector="hierarchicalInjector">
        <ng-template cdkTreeGroupContent>
          @for (child of node.children; track child) {
            <ng-template
              [ngTemplateOutlet]="nodeTmpl"
              [ngTemplateOutletContext]="{node: child}"
              [ngTemplateOutletInjector]="injector.injector"
            ></ng-template>
          }
        </ng-template>
      </div>
    }
  </li>
</ng-template>
